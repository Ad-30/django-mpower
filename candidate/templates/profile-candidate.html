{% extends 'candidate-index.html' %}

{% block title %}
<title>mpower - Candidate dashboard - Edit profile</title>
{% endblock %}

{% block content %}
{% load static %}

<div class="pxp-dashboard-content-details">
    <h1>Edit Profile</h1>
    <p class="pxp-text-light">Edit your candidate profile page info.</p>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row mt-4 mt-lg-5">
            <div class="col-xxl-8">
                <div class="mb-3">
                    <label for="pxp-candidate-name" class="form-label">Name</label>
                    <input type="text" id="pxp-candidate-name" class="form-control" placeholder="Add your name" name="name" value="{{ request.session.name }}">
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="mb-3">
                            <label for="pxp-candidate-title" class="form-label">Title</label>
                            {% if user.title %}
                                <input type="text" id="pxp-candidate-title" class="form-control" name="title" placeholder="E.g. Web Designer" value="{{ user.title }}">
                            {% else %}
                                <input type="text" id="pxp-candidate-title" class="form-control" name="title" placeholder="E.g. Web Designer">
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="mb-3">
                            <label for="pxp-candidate-location" class="form-label">Location</label>
                            <input type="tel" id="pxp-candidate-location" class="form-control" placeholder="E.g. San Francisco, CA" name="location" value="{{ user.location }}">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="mb-3">
                            <label for="pxp-candidate-email" class="form-label">Email</label>
                            <input type="email" id="pxp-candidate-email" class="form-control" placeholder="candidate@email.com" name="email" value="{{ log }}">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="mb-3">
                            <label for="pxp-candidate-phone" class="form-label">Phone</label>
                            <input type="tel" id="pxp-candidate-phone" class="form-control" placeholder="(+12) 345 6789" name="phone" value="{{ user.phone }}">
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xxl-4">
                <div class="form-label">&nbsp;</div>
                <div class="pxp-candidate-cover mb-3">
                    <input type="file" id="pxp-candidate-cover-choose-file" accept="image/*" width="100%" height="166px" name="photo">
                    {% if request.session.photo %}
                        <label for="pxp-candidate-cover-choose-file" class="pxp-cover" style="background-image: url('{{ request.session.photo }}')"><span>Update Photo</span></label>
                    {% else %}
                        <label for="pxp-candidate-cover-choose-file" class="pxp-cover"><span>Upload Photo</span></label>
                    {% endif %}
                {% comment %} </div>
                <div class="pxp-candidate-photo mb-3">
                    <input type="file" id="pxp-candidate-photo-choose-file" accept="image/*">
                    <label for="pxp-candidate-photo-choose-file" class="pxp-cover"><span>Upload<br>Photo</span></label>
                </div> {% endcomment %}
            </div>
        </div>

        <div class="mb-3">
            <label for="pxp-candidate-about" class="form-label">About you</label>
            <textarea class="form-control" id="pxp-candidate-about" placeholder="Type your info here..." name="about">{{ user.about }}</textarea>
        </div>

        <div class="mt-4 mt-lg-5">
            <h2>Skills</h2>
            <div class="pxp-candidate-dashboard-skills mb-3">
                <ul class="list-unstyled">
                    {% for i in skills %}
                    <li>{{ i }}<button class="delete_skill" style="border: none; padding: 0px; margin: 0px; background: none"><input style="display: none" value={{ i }} /><span class="fa fa-trash-o"></span></button></li>
                    {% endfor %}
                </ul>
            </div>
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Skill" name="skill">
                <button type="submit" class="btn skilladder">Add Skill</button>
        </form>
        </div>

        <div class="mt-4 mt-lg-5">
            <h2>Work Experience</h2>
            <div class="table-responsive">
                <table class="table align-middle">
                    {% for i in experience %}
                    <tr>
                        <td style="width: 30%;"><div class="pxp-candidate-dashboard-experience-title">{{ i.job_title }}</div></td>
                        <td style="width: 25%;"><div class="pxp-candidate-dashboard-experience-company">{{ i.company }}</div></td>
                        <td style="width: 25%;"><div class="pxp-candidate-dashboard-experience-time">{{ i.time_period }}</div></td>
                        <td>
                            <div class="pxp-dashboard-table-options">
                                <ul class="list-unstyled">
                                    <li><button title="Edit" id="pxp-signup-modal-button" onclick="return false;" data-bs-target="#pxp-signup-modal" data-bs-toggle="modal"><span class="fa fa-pencil"></span></button></li>
                                    <li><button title="Delete" class="delete_exp"><input style="display: none" value={{ i.exp_id }} /><span class="fa fa-trash-o"></span></button></li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

            <div class="row mt-3 mt-lg-4">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-work-title" class="form-label">Job title</label>
                        <input type="text" id="pxp-candidate-work-title" class="form-control" placeholder="E.g. Web Designer" name="job_title">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-work-company" class="form-label">Company</label>
                        <input type="text" id="pxp-candidate-work-company" class="form-control" placeholder="Company name" name="company">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-work-time" class="form-label">Time period</label>
                        <input type="text" id="pxp-candidate-work-time" class="form-control" placeholder="E.g. 2005 - 2013" name="time_period">
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="pxp-candidate-work-about" class="form-label">Description</label>
                <textarea class="form-control pxp-smaller" id="pxp-candidate-work-about" placeholder="Type a short description here..." name="description"></textarea>
            </div>
            <button class="btn rounded-pill pxp-subsection-cta addexper">Add Experience</button>
        </div>

        <div class="mt-4 mt-lg-5">
            <h2>Education & Training</h2>
            <div class="table-responsive">
                <table class="table align-middle">
                    {% for i in education %}
                    <tr>
                        <td style="width: 30%;"><div class="pxp-candidate-dashboard-experience-title">{{ i.title }}</div></td>
                        <td style="width: 25%;"><div class="pxp-candidate-dashboard-experience-school">{{ i.school }}</div></td>
                        <td style="width: 25%;"><div class="pxp-candidate-dashboard-experience-time">{{ i.time_period }}</div></td>
                        <td>
                            <div class="pxp-dashboard-table-options">
                                <ul class="list-unstyled">
                                    <li><button title="Edit" data-bs-target="#pxp-signup-modal" onclick="return false;"  data-bs-toggle="modal"><span class="fa fa-pencil"></span></button></li>
                                    <li><button title="Delete" class="delete_edu"><input style="display: none" value={{ i.edu_id }} /><span class="fa fa-trash-o"></span></button></li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </table>
            </div>

            <div class="row mt-3 mt-lg-4">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-edu-title" class="form-label">Title</label>
                        <input type="text" id="pxp-candidate-edu-title" class="form-control" placeholder="E.g. Architecure" name="edu_title">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-edu-school" class="form-label">School</label>
                        <input type="text" id="pxp-candidate-edu-school" class="form-control" placeholder="School name" name="school">
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="pxp-candidate-edu-time" class="form-label">Time period</label>
                        <input type="text" id="pxp-candidate-edu-time" class="form-control" placeholder="E.g. 2005 - 2013"  name="period_edu">
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="pxp-candidate-edu-about" class="form-label">Description</label>
                <textarea class="form-control pxp-smaller" id="pxp-candidate-edu-about" placeholder="Type a short description here..."  name="desc"></textarea>
            </div>
            <button class="btn rounded-pill pxp-subsection-cta addedu">Add Education</button>
        </div>

        <div class="mt-4 mt-lg-5">
            <button class="btn rounded-pill pxp-section-cta">Save Profile</button>
        </div>
    </form>
</div>
<div class="modal fade pxp-user-modal" id="pxp-signup-modal" aria-hidden="true" aria-labelledby="signupModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="pxp-user-modal-fig text-center">
                    <img src="{% static 'images/underconstruction.png' %}" alt="Sign up">
                </div>
                <h5 class="modal-title text-center mt-4" id="signupModal">Under Development</h5>
            </div>
        </div>
    </div>
</div>
{% endblock content %}

{% block script %}
$('.skilladder').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "add_skill/",
        data:{
                skill: $('[name="skill"]').val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('.addexper').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "add_exp/",
        data:{
                title: $('[name="job_title"]').val(),
                company: $('[name="company"]').val(),
                time_period: $('[name="time_period"]').val(),
                description: $('[name="description"]').val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('.addedu').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "add_edu/",
        data:{
                title: $('[name="edu_title"]').val(),
                school: $('[name="school"]').val(),
                period_edu: $('[name="period_edu"]').val(),
                desc: $('[name="desc"]').val(),
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('.delete_skill').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "delete_skill/",
        data:{
                val: $(this).children()[0].value,
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('.delete_exp').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "delete_exp/",
        data:{
                id: $(this).children()[0].value,
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('.delete_edu').click(function(e){
    e.preventDefault()
    $.ajax(
    {
        type:"POST",
        url: "delete_edu/",
        data:{
                id: $(this).children()[0].value,
                csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function( data ) 
        {
           window.location.reload();
        }
     })
})
$('#pxp-signup-modal-button').on('click', function() {
    $('#pxp-signup-modal').show();
});
$(document).ready(function () {
    $('#das').removeClass('pxp-active');
    $('#edi').addClass('pxp-active');
    $('#app').removeClass('pxp-active');
    $('#fav').removeClass('pxp-active');
    $('#cha').removeClass('pxp-active');
    $('#inb').removeClass('pxp-active');
    $('#not').removeClass('pxp-active');
    $('#res').removeClass('pxp-active');
    $('#fee').removeClass('pxp-active');
    $('#sug').removeClass('pxp-active');
})
{% endblock %}